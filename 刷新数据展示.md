# 数据刷新和展示说明

## 问题诊断

如果看不到数据，请检查以下几点：

### 1. 数据库数据是否存在

数据已经成功插入数据库，可以通过以下命令查看：

```bash
cd /Users/skyshi/code/CXPT
./show_test_data.sh
```

或直接查询数据库：

```bash
sqlite3 voice_community_backend/data/voice_community.db
SELECT COUNT(*) FROM USER WHERE is_deleted = 0;
SELECT COUNT(*) FROM voice WHERE is_deleted = 0;
```

### 2. 后端服务是否运行

**检查方法：**
```bash
curl http://localhost:8081/user/getAllUsers
```

如果返回错误或连接失败，说明后端服务未运行。

**启动后端服务：**
```bash
cd voice_community_backend
mvn spring-boot:run
```

或使用启动脚本：
```bash
cd deploy
./start-backend-local.sh
```

### 3. 前端是否能访问后端

**检查前端配置：**
- 移动端前端：检查 `vite.config.ts` 中的代理配置
- 后台管理前端：检查 API 基础路径配置

**刷新前端页面：**
- 强制刷新浏览器（Ctrl+F5 或 Cmd+Shift+R）
- 清除浏览器缓存

## 快速刷新脚本

已创建 `refresh_and_show_data.sh` 脚本，可以：
1. 检查数据库连接
2. 显示数据统计
3. 检查后端服务状态
4. 展示最新数据

运行方法：
```bash
./refresh_and_show_data.sh
```

## 数据统计

当前数据库中的数据量：
- **用户**: 28个
- **心声**: 70条（创意45条，员工声音25条）
- **评论**: 121条
- **点赞**: 257条
- **标签**: 4个
- **勋章**: 12个

## 常见问题

### Q: 数据库有数据，但前端看不到？
A: 检查后端服务是否运行，以及前端是否能正常访问后端API。

### Q: 后端服务启动失败？
A: 检查端口8081是否被占用，查看日志文件 `logs/backend.log`。

### Q: API返回空数据？
A: 检查数据库连接配置，确认数据库路径正确。

## 查看数据的多种方式

1. **直接查询数据库**
   ```bash
   sqlite3 voice_community_backend/data/voice_community.db
   ```

2. **通过API**
   ```bash
   curl http://localhost:8081/user/getAllUsers
   curl 'http://localhost:8081/voice/getVoicesByParam?pageNum=1&pageSize=10'
   ```

3. **通过前端界面**
   - 移动端: http://localhost:5173
   - 后台管理: http://localhost:3000

4. **使用展示脚本**
   ```bash
   ./show_test_data.sh
   ./refresh_and_show_data.sh
   ```

